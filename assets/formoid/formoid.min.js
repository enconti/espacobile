$(function() {

	// Get the form.
	var form = $('#ajax-contact');

	// Get the messages div.
    var formMessages = $('#form-messages');
    
    var $this   = $(this),
        $form   = $this.is('form') ? $this : $this.find('form'),
        $submit = $this.find('[type="submit"]'), 
        $alert  = $this.find('[data-form-alert]'),
        alertSuccess = $alert.html();

	// Set up an event listener for the contact form.
	$(form).submit(function(e) {
		// Stop the browser from submitting the form.
		e.preventDefault();

		// Serialize the form data.
        var formData = $(form).serialize();
        $alert.html('');

		// Submit the form using AJAX.
		$.ajax({
			type: 'POST',
			url: $(form).attr('action'),
            data: formData, 
            crossDomain: false
		})
		.done(function(message) {
            $form.removeClass('form-active');
            $this.find('[data-form-field]').val('');
            $alert.removeAttr('hidden');
            $alert.append($('<div class="alert alert-form alert-success text-xs-center"/>').text(alertSuccess || message));

			// Clear the form.
			$('#name').val('');
            $('#email').val('');
            $('#phone').val('');
			$('#message').val('');
		})
		.fail(function(error) {
			$alert.append($('<div class="alert alert-form alert-danger text-xs-center"/>').text(error));
		}).always(function(){
            $submit.removeClass('btn-loading').prop('disabled', false);
        });

	});

});
